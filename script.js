document.addEventListener('DOMContentLoaded', () => {
    // --- СЛОВАРЬ ДЛЯ ПЕРЕВОДА ИНТЕРФЕЙСА ---
    const translations = {
        home: { ru: 'Главная', ua: 'Головна' },
        search: { ru: 'Поиск', ua: 'Пошук' },
        settings: { ru: 'Настройки', ua: 'Налаштування' },
        album: { ru: 'АЛЬБОМ', ua: 'АЛЬБОМ' },
        title: { ru: 'НАЗВАНИЕ', ua: 'НАЗВА' },
        artist_col: { ru: 'АРТИСТ', ua: 'АРТИСТ' },
        theme: { ru: 'Тема', ua: 'Тема' },
        light: { ru: 'Светлая', ua: 'Світла' },
        dark: { ru: 'Тёмная', ua: 'Темна' },
        language: { ru: 'Язык', ua: 'Мова' },
        close: { ru: 'Закрыть', ua: 'Закрити' },
        search_placeholder: { ru: 'Что хотите послушать?', ua: 'Що хочете послухати?' }
    };

    // --- ВАШИ ПЕСНИ ---
    const defaultPlaylistTitle = 'Хиты ᴀɢʀᴏʜɪꜱǫ';
    const albumCover = 'images/cover1.jpg';

    const playlistData = [
        { id: 0, title: '11 - Кишлак', artist: 'Артист 1', duration: '?:??', file: 'sound/1.mp3' },
        { id: 1, title: '104972edf8590', artist: 'Артист 2', duration: '?:??', file: 'sound/2.mp3' },
        { id: 2, title: '1049728590', artist: 'Артист 3', duration: '?:??', file: 'sound/3.mp3' },
        { id: 3, title: 'Юра, Юра - CUPSIZE', artist: 'Артист 4', duration: '?:??', file: 'sound/4.mp3' },
        { id: 4, title: 'Марафеты - dabbackwood', artist: 'Артист 5', duration: '?:??', file: 'sound/5.mp3' },
        { id: 5, title: 'b0lit - dj trippie flameboy', artist: 'Артист 6', duration: '?:??', file: 'sound/6.mp3' },
        { id: 6, title: 'Кончил - Enina', artist: 'Артист 7', duration: '?:??', file: 'sound/7.mp3' },
        { id: 7, title: 'Дай мне посмотреть - Heronwater, BUSHIDO ZHO', artist: 'Артист 8', duration: '?:??', file: 'sound/8.mp3' },
        { id: 8, title: 'Купидон - KERASINN', artist: 'Артист 9', duration: '?:??', file: 'sound/9.mp3' },
        { id: 9, title: 'ЧСВ - Lida, Серега Пират', artist: 'Артист 10', duration: '?:??', file: 'sound/10.mp3' },
        { id: 10, title: 'Барыга - madk1d', artist: 'Артист 11', duration: '?:??', file: 'sound/11.mp3' },
        { id: 11, title: 'Кисы - котики - Measora', artist: 'Артист 12', duration: '?:??', file: 'sound/12.mp3' },
        { id: 12, title: 'Не киряй - Мукка, Три дня дождя', artist: 'Артист 13', duration: '?:??', file: 'sound/13.mp3' },
        { id: 13, title: 'Пошлая Блондинка - nnoluvv', artist: 'Артист 14', duration: '?:??', file: 'sound/14.mp3' },
        { id: 14, title: 'Miss the Rage - Playboi Carti', artist: 'Артист 15', duration: '?:??', file: 'sound/15.mp3' },
        { id: 15, title: 'Sky - Playboi Carti', artist: 'Артист 16', duration: '?:??', file: 'sound/16.mp3' },
        { id: 16, title: 'Rock That Body - The Black Eyed Peas', artist: 'Артист 17', duration: '?:??', file: 'sound/17.mp3' },
        { id: 17, title: 'Катюха - whitek3d', artist: 'Артист 18', duration: '?:??', file: 'sound/18.mp3' },
        { id: 18, title: 'А чё чё - Бьянка', artist: 'Артист 19', duration: '?:??', file: 'sound/19.mp3' },
        { id: 19, title: 'Песня для девочек - Валентин Стрыкало', artist: 'Артист 20', duration: '?:??', file: 'sound/20.mp3' },
        { id: 20, title: 'Буря, метель и мгла - Канги, mzlff, STED.D', artist: 'Артист 21', duration: '?:??', file: 'sound/21.mp3' },
        { id: 21, title: 'Контракт - Пошлая Молли', artist: 'Артист 22', duration: '?:??', file: 'sound/22.mp3' },
        { id: 22, title: 'Клубника - Кузнецкий Сквад', artist: 'Артист 23', duration: '?:??', file: 'sound/23.mp3' },
        { id: 23, title: 'Мулен Руж - Бьянка', artist: 'Артист 24', duration: '?:??', file: 'sound/24.mp3' },
        { id: 24, title: 'Я очень устал - Пасош', artist: 'Артист 25', duration: '?:??', file: 'sound/25.mp3' },
        { id: 25, title: 'Пачка сигарет - Кино (Виктор Цой)', artist: 'Артист 26', duration: '?:??', file: 'sound/26.mp3' },
        { id: 26, title: 'Нон стоп - Пошлая Молли', artist: 'Артист 27', duration: '?:??', file: 'sound/27.mp3' },
        { id: 27, title: 'Паки пуси - Пошлая Молли', artist: 'Артист 28', duration: '?:??', file: 'sound/28.mp3' },
        { id: 28, title: 'Священная война - Урал Гайсин', artist: 'Артист 29', duration: '?:??', file: 'sound/29.mp3' },
        // ++ ВОТ ВАШ НОВЫЙ ТРЕК ++
        { id: 29, title: '_bedwars_pro_', artist: 'Артист 30', duration: '?:??', file: 'sound/30.mp3' }
    ];
    
    // Остальной код остается без изменений, он будет работать с новыми данными
    const musicPlayer=document.getElementById("music-player"),playerBar=document.querySelector(".player-bar"),songListBody=document.getElementById("song-list-body"),mainPlaylistCover=document.getElementById("playlist-cover"),mainPlaylistTitle=document.getElementById("playlist-title"),navItems={home:document.getElementById("nav-home"),search:document.getElementById("nav-search")},views={home:document.getElementById("home-view"),search:document.getElementById("search-view")},searchInput=document.getElementById("search-input"),searchResultsContainer=document.getElementById("search-results-container"),settingsModal=document.getElementById("settings-modal"),settingsBtn=document.getElementById("settings-btn"),closeModalBtn=document.getElementById("close-modal-btn"),themeToggle=document.getElementById("theme-toggle"),languageSelector=document.getElementById("language-selector");let playPauseBtn,prevBtn,nextBtn,progressBar,volumeBar,currentTimeEl,totalDurationEl,nowPlayingCover,nowPlayingTitle,nowPlayingArtist,currentTrackIndex=0,isPlaying=!1,resumeTime=0;function saveState(){const e={theme:document.body.classList.contains("light-theme")?"light":"dark",language:languageSelector.value,playlistTitle:mainPlaylistTitle.textContent,lastTrackIndex:currentTrackIndex,lastTrackTime:isPlaying?musicPlayer.currentTime:resumeTime};localStorage.setItem("agrohisq_state",JSON.stringify(e))}function loadState(){const e=JSON.parse(localStorage.getItem("agrohisq_state")),t={theme:"dark",language:"ru",playlistTitle:defaultPlaylistTitle,lastTrackIndex:0,lastTrackTime:0},a={...t,...e};document.body.classList.toggle("light-theme","light"===a.theme),themeToggle.checked="dark"===a.theme,languageSelector.value=a.language,mainPlaylistTitle.textContent=a.playlistTitle,currentTrackIndex=a.lastTrackIndex,resumeTime=a.lastTrackTime,setLanguage(a.language)}function setLanguage(e){Object.keys(translations).forEach(t=>{const a=document.querySelector(`[data-translate-key="${t}"]`);a&&translations[t][e]&&(a.textContent=translations[t][e]);const o=document.querySelector(`[data-translate-placeholder="${t}"]`);o&&translations[t][e]&&(o.placeholder=translations[t][e])})}function switchView(e){Object.values(views).forEach(e=>e.classList.remove("active-view")),views[e].classList.add("active-view"),Object.values(navItems).forEach(e=>e.classList.remove("active")),navItems[e].classList.add("active")}function renderPlaylist(e,t){e.innerHTML="",t.forEach(t=>{const a=playlistData.findIndex(e=>e.id===t.id),o=document.createElement("tr");o.dataset.index=a,o.innerHTML=`<td>${a+1}</td><td><div style="display:flex; align-items:center;"><img src="${albumCover}" width="40" height="40" style="margin-right:12px;"><div><div>${t.title}</div><div style="font-size:12px; color:var(--text-muted-color);">${t.artist}</div></div></div></td><td>${mainPlaylistTitle.textContent}</td><td>${t.duration}</td>`,e.appendChild(o)})}function performSearch(){const e=searchInput.value.toLowerCase();if(!e)return void(searchResultsContainer.innerHTML="");const t=playlistData.filter(t=>t.title.toLowerCase().includes(e)||t.artist.toLowerCase().includes(e)),a=document.createElement("table");a.className="song-table";const o=document.createElement("tbody");a.appendChild(o),searchResultsContainer.innerHTML="",searchResultsContainer.appendChild(a),renderPlaylist(o,t)}function loadTrack(e){currentTrackIndex=e;const t=playlistData[e];musicPlayer.src=t.file,nowPlayingCover.src=albumCover,nowPlayingTitle.textContent=t.title,nowPlayingArtist.textContent=t.artist,document.title=`${t.title} · ${t.artist}`}function play(){isPlaying=!0,musicPlayer.play(),playPauseBtn.querySelector(".play-icon").style.display="none",playPauseBtn.querySelector(".pause-icon").style.display="block"}function pause(){isPlaying=!1,musicPlayer.pause(),resumeTime=musicPlayer.currentTime,playPauseBtn.querySelector(".play-icon").style.display="block",playPauseBtn.querySelector(".pause-icon").style.display="none"}function prevTrack(){const e=(currentTrackIndex-1+playlistData.length)%playlistData.length;loadTrack(e),play()}function nextTrack(){const e=(currentTrackIndex+1)%playlistData.length;loadTrack(e),play()}function updateProgress(){const{duration:e,currentTime:t}=musicPlayer;if(e){progressBar.value=t/e*100||0;const a=e=>`${Math.floor(e/60)}:${String(Math.floor(e%60)).padStart(2,"0")}`;currentTimeEl.textContent=a(t),totalDurationEl.textContent=a(e)}}function init(){playerBar.innerHTML=`<div class="now-playing"><img src="" alt="Now Playing" id="now-playing-cover"><div class="track-info"><div id="now-playing-title"></div><div id="now-playing-artist"></div></div></div><div class="player-controls-center"><div class="player-buttons"><button class="control-btn shuffle"><svg viewBox="0 0 24 24"><path fill="currentColor" d="M14.83,13.41L13.42,14.82L16.24,17.65L14.83,19.06L17.66,21.89L19.07,20.47L14.83,16.23M19.07,3.53L17.66,2.11L14.83,4.94L16.24,6.35L19.07,3.53M7.06,8.5L8.5,7.05L12.7,11.25L7.05,16.9L5.64,15.47L9.85,11.25L7.06,8.5M17.65,11.26L16.24,12.67L14.83,11.26L13.42,12.67L10.59,9.84L12,8.42L16.24,12.67L17.65,11.26Z" /></svg></button><button id="prev-btn" class="control-btn"><svg viewBox="0 0 24 24"><path fill="currentColor" d="M6,18V6H8V18H6M9.5,12L18,6V18L9.5,12Z" /></svg></button><button id="play-pause-btn" class="control-btn play"><svg class="play-icon" viewBox="0 0 24 24"><path fill="currentColor" d="M8,5.14V19.14L19,12.14L8,5.14Z" /></svg><svg class="pause-icon" viewBox="0 0 24 24" style="display:none;"><path fill="currentColor" d="M14,19H18V5H14M6,19H10V5H6V19Z" /></svg></button><button id="next-btn" class="control-btn"><svg viewBox="0 0 24 24"><path fill="currentColor" d="M16,18H18V6H16M6,18L14.5,12L6,6V18Z" /></svg></button><button class="control-btn repeat"><svg viewBox="0 0 24 24"><path fill="currentColor" d="M17,17H7V14L3,18L7,22V19H19V13H17M7,7H17V10L21,6L17,2V5H5V11H7V7Z" /></svg></button></div><div class="progress-container-main"><span id="current-time" class="time">0:00</span><input type="range" id="progress-bar" class="progress-bar" value="0"><span id="total-duration" class="time">0:00</span></div></div><div class="player-controls-right"><span class="volume-icon"><svg viewBox="0 0 24 24"><path fill="currentColor" d="M14,3.23V5.29C16.89,6.15 19,8.83 19,12C19,15.17 16.89,17.84 14,18.7V20.77C18,19.86 21,16.28 21,12C21,7.72 18,4.14 14,3.23M16.5,12C16.5,10.23 15.5,8.71 14,7.97V16C15.5,15.29 16.5,13.76 16.5,12M3,9V15H7L12,20V4L7,9H3Z" /></svg></span><input type="range" id="volume-bar" class="volume-bar" value="100"></div>`,playPauseBtn=document.getElementById("play-pause-btn"),prevBtn=document.getElementById("prev-btn"),nextBtn=document.getElementById("next-btn"),progressBar=document.getElementById("progress-bar"),volumeBar=document.getElementById("volume-bar"),currentTimeEl=document.getElementById("current-time"),totalDurationEl=document.getElementById("total-duration"),nowPlayingCover=document.getElementById("now-playing-cover"),nowPlayingTitle=document.getElementById("now-playing-title"),nowPlayingArtist=document.getElementById("now-playing-artist"),loadState(),mainPlaylistCover.src=albumCover,renderPlaylist(songListBody,playlistData),loadTrack(currentTrackIndex),navItems.home.addEventListener("click",()=>switchView("home")),navItems.search.addEventListener("click",()=>switchView("search")),settingsBtn.addEventListener("click",()=>settingsModal.classList.add("show")),closeModalBtn.addEventListener("click",()=>settingsModal.classList.remove("show")),window.addEventListener("click",e=>{e.target===settingsModal&&settingsModal.classList.remove("show")}),themeToggle.addEventListener("change",()=>{applyTheme(themeToggle.checked?"dark":"light"),saveState()}),languageSelector.addEventListener("change",()=>{setLanguage(languageSelector.value),saveState()}),mainPlaylistTitle.addEventListener("blur",saveState),searchInput.addEventListener("input",performSearch),playPauseBtn.addEventListener("click",()=>isPlaying?pause():play()),prevBtn.addEventListener("click",prevTrack),nextBtn.addEventListener("click",nextTrack),musicPlayer.addEventListener("timeupdate",updateProgress),musicPlayer.addEventListener("ended",nextTrack),musicPlayer.addEventListener("loadedmetadata",()=>{resumeTime&&(musicPlayer.currentTime=resumeTime,resumeTime=0),updateProgress()}),volumeBar.addEventListener("input",e=>{musicPlayer.volume=e.target.value/100}),progressBar.addEventListener("input",()=>{musicPlayer.duration&&(musicPlayer.currentTime=progressBar.value/100*musicPlayer.duration)}),document.querySelector(".main-content").addEventListener("click",e=>{const t=e.target.closest("tr");if(t?.dataset.index){const e=parseInt(t.dataset.index,10);e===currentTrackIndex&&isPlaying||(loadTrack(e),play())}}),window.addEventListener("beforeunload",saveState)}init();
});
